{% macro prev_div_macro(id, previous = []) %}

{% from "elements.html.jinja" import label_macro %}
{% from "/profile/macro.html.jinja" import collapse_header_macro, action_group_macro %}
{% from "/profile/forms/previous.html.jinja" import prev_form_macro %}

{% call collapse_header_macro("previous-0") %}
{{'Предыдущее имя'}}
{% endcall %}
<div class="collapse card card-body mb-3" id="previous-0">
  {{ prev_form_macro(id) }}
</div>

{% if previous %}
{% for prev in previous %}
<div  class="card card-body mb-3">
  {% call label_macro("Фамилия") %}
  {{ prev['surname'] }}
  {% endcall %}

  {% call label_macro("Имя") %}
  {{ prev['firstname'] }}
  {% endcall %}

  {% call label_macro("Отчество") %}
  {{ prev['patronymic'] }}
  {% endcall %}

  {% call label_macro("Год изменения") %}
  {{ prev['changed'] }}
  {% endcall %}

  {% call label_macro("Причина изменения") %}
  {{ prev['reason'] }}
  {% endcall %}

  {% if session['user']['role'] == 'user' %}
  {{ action_group_macro("previous", prev['id']|string) }}
  <div class="collapse card card-body mb-3" id="{{'previous-' + prev['id']|string}}">
    {{ prev_form_macro(id, prev) }}
  </div>
  {% endif %}

</div>
  {% endfor %}
  {% else %}
  <div class="text-primary mb-3">Информация не найдена</div>
  {% endif %}

{% endmacro %}
