const __vite__fileDeps=["assets/HeaderDiv-Bjks6c5q.js","assets/index-C5gLaoji.js","assets/index-D3owuatg.css","assets/TableSlots-DLCx_Olv.js","assets/ModalWin-Y8Tk4nJs.js","assets/ConnectDiv-BUgO-Ven.js","assets/PageSwitcher-BNolqZMk.js","assets/ConnectForm-D6O6shpL.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as L,n as O,q as R,h as g,s as f,o as v,c as h,b as i,u as s,t as m,v as b,a as t,z as S,y as B,w as _,M,E as N,F as w,x as z,C as l,B as F,e as c,H as j,j as C,f as r}from"./index-C5gLaoji.js";const q={class:"mb-5"},H=t("tr",null,[t("th",{width:"18%"},"Название"),t("th",{width:"18%"},"Имя"),t("th",{width:"18%"},"Телефон"),t("th",{width:"18%"},"Добавочный"),t("th",{width:"18%"},"Мобильный"),t("th",{width:"5%"}),t("th",{width:"5%"})],-1),G=["onClick"],U=["onClick"],W=t("i",{class:"bi bi-pencil-square"},null,-1),J=[W],K={width:"5%"},Q=["onClick"],X=t("i",{class:"bi bi-trash"},null,-1),Y=[X],te=L({__name:"ContactPage",setup(Z){const x=c(()=>r(()=>import("./HeaderDiv-Bjks6c5q.js"),__vite__mapDeps([0,1,2]))),E=c(()=>r(()=>import("./TableSlots-DLCx_Olv.js"),__vite__mapDeps([3,1,2]))),y=c(()=>r(()=>import("./ModalWin-Y8Tk4nJs.js"),__vite__mapDeps([4,1,2]))),k=c(()=>r(()=>import("./ConnectDiv-BUgO-Ven.js"),__vite__mapDeps([5,1,2]))),D=c(()=>r(()=>import("./PageSwitcher-BNolqZMk.js"),__vite__mapDeps([6,1,2]))),A=c(()=>r(()=>import("./ConnectForm-D6O6shpL.js"),__vite__mapDeps([7,1,2])));O(async()=>{await u(1)});const p=j(()=>{u(1)},500),e=R({names:[],companies:[],cities:[],contacts:[],page:1,prev:!1,next:!1,action:"",search:"",item:{}});async function u(o){e.value.action="";try{const n=await g.get(`${f}/connect/${o}`,{params:{search:e.value.search}}),[a,d,$,V,I,T]=n.data;Object.assign(e.value,{contacts:a,names:V.names,companies:I.companies,cities:T.cities,prev:d.has_prev,next:$.has_next})}catch(n){console.error(n)}}async function P(o){if(confirm("Вы действительно хотите удалить контакт?"))try{const n=await g.delete(`${f}/connect/${o}`);console.log(n.status),C.setAlert("alert-success",`Контакт с ID ${o} удален`),u(e.value.page)}catch(n){console.log(n),C.setAlert("alert-danger",`Ошибка при удалении контакта с ID ${o}`)}}return(o,n)=>(v(),h(w,null,[i(s(x),{"page-header":e.value.action?"Изменить/добавить контакт":"Контакты"},null,8,["page-header"]),m(i(s(A),{page:e.value.page,action:e.value.action,names:e.value.names,companies:e.value.companies,cities:e.value.cities,item:e.value.item,onGetContacts:u,onCancelEdit:n[0]||(n[0]=a=>e.value.action="")},null,8,["page","action","names","companies","cities","item"]),[[b,e.value.action]]),m(t("div",q,[m(t("input",{onInput:n[1]||(n[1]=S((...a)=>s(p)&&s(p)(...a),["prevent"])),class:"form-control mb-5",name:"search",id:"search",type:"text",placeholder:"Поиск по организации, имени, номеру мобильного телефона","onUpdate:modelValue":n[2]||(n[2]=a=>e.value.search=a)},null,544),[[B,e.value.search]]),i(s(y),{id:"modalConnect",title:e.value.item.fullname,size:"modal-md"},{default:_(()=>[i(s(k),{item:e.value.item},null,8,["item"])]),_:1},8,["title"]),i(s(E),{class:N({"table-hover":e.value.contacts.length>0})},M({caption:_(()=>[F(l("Список контактов"))]),thead:_(()=>[H]),_:2},[e.value.contacts.length>0?{name:"tbody",fn:_(()=>[(v(!0),h(w,null,z(e.value.contacts,a=>(v(),h("tr",{key:a.id},[t("td",null,l(a.company),1),t("td",null,[t("a",{href:"#",title:"Посмотреть контакт","data-bs-target":"#modalConnect","data-bs-toggle":"modal",onClick:d=>e.value.item=a},l(a.fullname),9,G)]),t("td",null,l(a.phone),1),t("td",null,l(a.adding),1),t("td",null,l(a.mobile),1),t("td",null,[t("a",{class:"btn btn-link",type:"button",title:"Изменить контакт",onClick:d=>{e.value.action="edit",e.value.item=a}},J,8,U)]),t("td",K,[t("a",{href:"#",title:"Удалить",onClick:d=>P(a.id)},Y,8,Q)])]))),128))]),key:"0"}:void 0]),1032,["class"]),t("button",{class:"btn btn-link text-end",role:"button",onClick:n[3]||(n[3]=a=>e.value.action="create")}," Добавить контакт "),i(s(D),{has_prev:e.value.next,has_next:e.value.prev,switchPrev:e.value.page-1,switchNext:e.value.page+1,onSwitch:u},null,8,["has_prev","has_next","switchPrev","switchNext"])],512),[[b,!e.value.action]])],64))}});export{te as default};
