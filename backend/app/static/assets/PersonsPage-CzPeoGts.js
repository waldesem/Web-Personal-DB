const __vite__fileDeps=["./HeaderDiv-Db67IQx8.js","./index-DRtVOEFB.js","./index-6fGrG267.css","./FileForm-DUVjWFW4.js","./_plugin-vue_export-helper-DlAUqK2U.js","./FileForm-By8_2B11.css","./TableSlots-B4WUrcYy.js","./PageSwitcher-kt1WeSNs.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as L,i as E,n as R,j as T,c as n,a as c,u as i,f as s,q as C,v as V,s as A,g as N,w as p,F as h,l as U,o,x as f,t as a,r as g,y as B,b as d,e as m}from"./index-DRtVOEFB.js";import{b as F,s as I,t as O,d as q}from"./utilities-BFRXa8zy.js";import{c as M}from"./state-Skb32c17.js";const j={class:"position-relative"},z={class:"position-absolute bottom-100 end-0"},H={key:0,class:"spinner-border text-primary",style:{width:"3rem",height:"3rem"},role:"status"},J={key:1,for:"file",class:"text-primary"},G=s("i",{class:"bi bi-cloud-arrow-down fs-1",title:"Загрузить анкету",style:{cursor:"pointer"}},null,-1),K=[G],Q={class:"row mb-3"},W={class:"form form-check",role:"form"},X=s("i",{class:"bi bi-arrow-clockwise"},null,-1),Y=[X],Z={height:"50px"},ee=["width"],te={key:1},ne=L({__name:"PersonsPage",setup(se){const w=d(()=>m(()=>import("./HeaderDiv-Db67IQx8.js"),__vite__mapDeps([0,1,2]),import.meta.url)),y=d(()=>m(()=>import("./FileForm-DUVjWFW4.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url)),b=d(()=>m(()=>import("./TableSlots-B4WUrcYy.js"),__vite__mapDeps([6,1,2]),import.meta.url)),x=d(()=>m(()=>import("./PageSwitcher-kt1WeSNs.js"),__vite__mapDeps([7,1,2]),import.meta.url));E(async()=>{await u()});const D={Проверка:"primary",ПФО:"info",Окончено:"secondary",Сохранено:"danger"},$={id:["#","5%"],region_id:["Регион","15%"],surname:["Фамилия Имя Отчество","25%"],birthday:["Дата рождения","15%"],status:["Статус","10%"],created:["Создан","15%"],user:["Сотрудник","15%"]},t=R({candidates:[],page:1,prev:!1,next:!1,search:"",spinner:!1,updated:`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`});async function u(l=1){t.value.page=l;try{const r=await F.get(`${I}/index/${t.value.page}`,{params:{search:t.value.search}});[t.value.candidates,t.value.next,t.value.prev]=r.data,t.value.updated=`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`}catch(r){r.request.status==401||r.request.status==403?T.push({name:"login"}):console.error(r)}}const v=q(()=>{u()},500);async function k(l){t.value.spinner=!0,M(l,"persons","0"),t.value.spinner=!1}const S=l=>{const[r,_]=l.split(" ");return`${r} ${_}`};return(l,r)=>{const _=U("router-link");return o(),n(h,null,[c(i(w),{"page-header":"Кандидаты"}),s("div",j,[s("div",z,[t.value.spinner?(o(),n("span",H)):(o(),n("label",J,K)),c(i(y),{accept:".json",onSubmit:k},null,8,["accept"])])]),s("div",Q,[s("form",W,[C(s("input",{onInput:r[0]||(r[0]=A((...e)=>i(v)&&i(v)(...e),["prevent"])),class:"form-control",name:"search",id:"search",type:"text",placeholder:"поиск по фамилии, имени, отчеству, инн","onUpdate:modelValue":r[1]||(r[1]=e=>t.value.search=e)},null,544),[[V,t.value.search]])])]),t.value.candidates.length?(o(),N(i(b),{key:0,"div-class":"table align-middle py-3"},{caption:p(()=>[f(a(`Обновлено: ${t.value.updated}`)+" ",1),s("a",{href:"#",title:"Обновить",onClick:r[2]||(r[2]=e=>u())},Y)]),thead:p(()=>[s("tr",Z,[(o(),n(h,null,g($,(e,P)=>s("th",{key:P,width:e[1]},a(e[0]),9,ee)),64))])]),tbody:p(()=>[(o(!0),n(h,null,g(t.value.candidates,e=>(o(),n("tr",{key:e.id,height:"50px"},[s("td",null,a(e.id),1),s("td",null,a(e.region),1),s("td",null,[c(_,{to:{name:"profile",params:{id:e.id}}},{default:p(()=>[f(a(`${e.surname} ${e.firstname} ${e.patronymic?e.patronymic:""}`),1)]),_:2},1032,["to"])]),s("td",null,a(new Date(e.birthday).toLocaleDateString("ru-RU")),1),s("td",null,[s("label",{class:B(`fs-6 badge bg-${D[e.status]}`)},a(e.status),3)]),s("td",null,a(i(O)(e.created)),1),s("td",null,a(e.username?S(e.username.toString()):""),1)]))),128))]),_:1})):(o(),n("p",te,"Ничего не найдено")),c(i(x),{has_prev:t.value.prev,has_next:t.value.next,switchPrev:t.value.page-1,switchNext:t.value.page+1,onSwitch:u},null,8,["has_prev","has_next","switchPrev","switchNext"])],64)}}});export{ne as default};
