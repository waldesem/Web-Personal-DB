const __vite__fileDeps=["./HeaderDiv-C0AWTJb8.js","./index-Dx3HiUnq.js","./index-6fGrG267.css","./FileForm-CVXWBM0I.js","./_plugin-vue_export-helper-DlAUqK2U.js","./FileForm-By8_2B11.css","./TableSlots-Cqclv49u.js","./PageSwitcher-B07JiuLa.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as L,i as E,n as R,j as T,c as i,b as c,u as l,a as s,q as C,v as V,s as A,g as N,w as p,F as h,l as U,o as a,x as f,t as r,r as g,y as B,e as d,f as _}from"./index-Dx3HiUnq.js";import{b as F,s as I,t as O,d as q}from"./utilities-BVKB9Dez.js";import{c as M}from"./state-s_e9P3m1.js";const j={class:"position-relative"},z={class:"position-absolute bottom-100 end-0"},H={key:0,class:"spinner-border text-primary"},J={key:1,for:"file",class:"text-primary"},G=s("i",{class:"bi bi-cloud-arrow-down fs-1",title:"Загрузить анкету",style:{cursor:"pointer"}},null,-1),K=[G],Q={class:"row mb-3"},W={class:"form form-check",role:"form"},X=s("i",{class:"bi bi-arrow-clockwise"},null,-1),Y=[X],Z={height:"50px"},ee=["width"],te={key:1},ne=L({__name:"PersonsPage",setup(se){const w=d(()=>_(()=>import("./HeaderDiv-C0AWTJb8.js"),__vite__mapDeps([0,1,2]),import.meta.url)),y=d(()=>_(()=>import("./FileForm-CVXWBM0I.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url)),b=d(()=>_(()=>import("./TableSlots-Cqclv49u.js"),__vite__mapDeps([6,1,2]),import.meta.url)),x=d(()=>_(()=>import("./PageSwitcher-B07JiuLa.js"),__vite__mapDeps([7,1,2]),import.meta.url));E(async()=>{await u()});const D={Проверка:"primary",ПФО:"info",Окончено:"secondary"},$={id:["#","5%"],region_id:["Регион","15%"],surname:["Фамилия Имя Отчество","25%"],birthday:["Дата рождения","15%"],status:["Статус","10%"],created:["Создан","15%"],user:["Сотрудник","15%"]},t=R({candidates:[],page:1,prev:!1,next:!1,search:"",spinner:!1,updated:`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`});async function u(n=1){t.value.page=n;try{const o=await F.get(`${I}/index/${t.value.page}`,{params:{search:t.value.search}});[t.value.candidates,t.value.next,t.value.prev]=o.data,t.value.updated=`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`}catch(o){o.request.status==401||o.request.status==403?T.push({name:"login"}):console.error(o)}}const v=q(()=>{u()},500);async function k(n){n.preventDefault(),t.value.spinner=!0,M(n,"persons","0"),t.value.spinner=!1}const S=n=>{const[o,m]=n.split(" ");return`${o} ${m}`};return(n,o)=>{const m=U("router-link");return a(),i(h,null,[c(l(w),{"page-header":"Кандидаты"}),s("div",j,[s("div",z,[t.value.spinner?(a(),i("span",H)):(a(),i("label",J,K)),c(l(y),{accept:".json",onSubmit:k})])]),s("div",Q,[s("form",W,[C(s("input",{onInput:o[0]||(o[0]=A((...e)=>l(v)&&l(v)(...e),["prevent"])),class:"form-control",name:"search",id:"search",type:"text",placeholder:"поиск по фамилии, имени, отчеству, инн","onUpdate:modelValue":o[1]||(o[1]=e=>t.value.search=e)},null,544),[[V,t.value.search]])])]),t.value.candidates.length?(a(),N(l(b),{key:0,"div-class":"table align-middle py-3"},{caption:p(()=>[f(r(`Обновлено: ${t.value.updated}`)+" ",1),s("a",{href:"#",title:"Обновить",onClick:o[2]||(o[2]=e=>u())},Y)]),thead:p(()=>[s("tr",Z,[(a(),i(h,null,g($,(e,P)=>s("th",{key:P,width:e[1]},r(e[0]),9,ee)),64))])]),tbody:p(()=>[(a(!0),i(h,null,g(t.value.candidates,e=>(a(),i("tr",{key:e.id,height:"50px"},[s("td",null,r(e.id),1),s("td",null,r(e.region),1),s("td",null,[c(m,{to:{name:"profile",params:{id:e.id}}},{default:p(()=>[f(r(`${e.surname} ${e.firstname} ${e.patronymic?e.patronymic:""}`),1)]),_:2},1032,["to"])]),s("td",null,r(new Date(e.birthday).toLocaleDateString("ru-RU")),1),s("td",null,[s("label",{class:B(`fs-6 badge bg-${D[e.status]}`)},r(e.status),3)]),s("td",null,r(l(O)(e.created)),1),s("td",null,r(e.username?S(e.username.toString()):""),1)]))),128))]),_:1})):(a(),i("p",te,"Ничего не найдено")),c(l(x),{has_prev:t.value.prev,has_next:t.value.next,switchPrev:t.value.page-1,switchNext:t.value.page+1,onSwitch:u},null,8,["has_prev","has_next","switchPrev","switchNext"])],64)}}});export{ne as default};
