const __vite__fileDeps=["./HeaderDiv-CPHSjRiY.js","./index-a1q1DOXp.js","./index-6fGrG267.css","./FileForm-DJvR_uvm.js","./_plugin-vue_export-helper-DlAUqK2U.js","./FileForm-DJXAWPLZ.css","./TableSlots-DBoAf_h4.js","./AscDesc-DODHauf3.js","./AscDesc-BQH9JYAH.css","./PageSwitcher-VX3h290t.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as V,i as F,n as b,j as I,c as d,b as i,u as o,a as s,q as U,v as B,s as N,g as O,w as _,F as h,l as q,o as u,x as f,t as a,r as x,y as M,e as p,f as m}from"./index-a1q1DOXp.js";import{s as S,t as j,d as z}from"./utilities-DuY9392d.js";import{d as $,e as E}from"./state-8kq10HP3.js";const H={class:"position-relative"},G={class:"position-absolute bottom-100 end-0"},J=s("label",{for:"file",class:"text-primary"},[s("i",{class:"bi bi-cloud-arrow-down fs-1",title:"Загрузить анкету",style:{cursor:"pointer"}})],-1),K={class:"row mb-3"},Q={class:"form form-check",role:"form"},W=s("i",{class:"bi bi-arrow-clockwise"},null,-1),X=[W],Y={height:"50px"},Z=["width"],ee={key:1},ae=V({__name:"PersonsPage",setup(te){const P=p(()=>m(()=>import("./HeaderDiv-CPHSjRiY.js"),__vite__mapDeps([0,1,2]),import.meta.url)),A=p(()=>m(()=>import("./FileForm-DJvR_uvm.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url)),C=p(()=>m(()=>import("./TableSlots-DBoAf_h4.js"),__vite__mapDeps([6,1,2]),import.meta.url)),g=p(()=>m(()=>import("./AscDesc-DODHauf3.js"),__vite__mapDeps([7,1,2,4,8]),import.meta.url)),L=p(()=>m(()=>import("./PageSwitcher-VX3h290t.js"),__vite__mapDeps([9,1,2]),import.meta.url));F(async()=>{await n()});const k={Проверка:"primary",ПФО:"info",Отменено:"secondary",Окончено:"secondary"},R={id:["#","10%"],region_id:["Регион","15%"],surname:["Фамилия Имя Отчество","20%"],birthday:["Дата рождения","15%"],status:["Статус","10%"],created:["Создан","10%"],user:["Сотрудник","20%"]},t=b({candidates:[],page:1,prev:!1,next:!1,search:"",sort:"status",order:"asc",updated:`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`});async function n(l=1){t.value.page=l;try{const r=await $.get(`${S}/index/${t.value.page}`,{params:{search:t.value.search,sort:t.value.sort,order:t.value.order}});[t.value.candidates,t.value.next,t.value.prev]=r.data,t.value.updated=`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`}catch(r){r.request.status==401||r.request.status==403?I.push({name:"login"}):console.error(r)}}function w(l,r){t.value.sort=l,t.value.order=r,n()}const y=z(()=>{n()},500),D=b(new FormData);async function T(l){const r=l.target;if(r.files){D.value.append("file",r.files[0]);try{const c=await $.post(`${S}/file/anketa/0`,D.value);console.log(c.status),n(),E.setAlert("alert-success","Файл успешно загружен")}catch(c){console.error(c)}}else E.setAlert("alert-warning","Ошибка при загрузке файла")}return(l,r)=>{const c=q("router-link");return u(),d(h,null,[i(o(P),{"page-header":"Кандидаты"}),s("div",H,[s("div",G,[J,i(o(A),{accept:".json",onSubmit:T})])]),s("div",K,[s("form",Q,[U(s("input",{onInput:r[0]||(r[0]=N((...e)=>o(y)&&o(y)(...e),["prevent"])),class:"form-control",name:"search",id:"search",type:"text",placeholder:"поиск по фамилии, имени, отчеству, инн","onUpdate:modelValue":r[1]||(r[1]=e=>t.value.search=e)},null,544),[[B,t.value.search]])])]),t.value.candidates.length?(u(),O(o(C),{key:0,"div-class":"table caption-top align-middle py-3"},{caption:_(()=>[f(a(`Обновлено: ${t.value.updated}`)+" ",1),s("a",{href:"#",title:"Обновить",onClick:r[2]||(r[2]=e=>n())},X)]),thead:_(()=>[s("tr",Y,[(u(),d(h,null,x(R,(e,v)=>s("th",{key:v,width:e[1]},[f(a(e[0])+" ",1),i(o(g),{order:"desc",sort:v,onSortCandidates:w},null,8,["sort"]),i(o(g),{order:"asc",sort:v,onSortCandidates:w},null,8,["sort"])],8,Z)),64))])]),tbody:_(()=>[(u(!0),d(h,null,x(t.value.candidates,e=>(u(),d("tr",{key:e.id,height:"50px"},[s("td",null,a(e.id),1),s("td",null,a(e.region),1),s("td",null,[i(c,{to:{name:"profile",params:{id:e.id}}},{default:_(()=>[f(a(`${e.surname} ${e.firstname} ${e.patronymic?e.patronymic:""}`),1)]),_:2},1032,["to"])]),s("td",null,a(new Date(e.birthday).toLocaleDateString("ru-RU")),1),s("td",null,[s("label",{class:M(`fs-6 badge bg-${k[e.status]}`)},a(e.status),3)]),s("td",null,a(o(j)(e.created)),1),s("td",null,a(e.username?e.username:""),1)]))),128))]),_:1})):(u(),d("p",ee,"Ничего не найдено")),i(o(L),{has_prev:t.value.prev,has_next:t.value.next,switchPrev:t.value.page-1,switchNext:t.value.page+1,onSwitch:n},null,8,["has_prev","has_next","switchPrev","switchNext"])],64)}}});export{ae as default};
