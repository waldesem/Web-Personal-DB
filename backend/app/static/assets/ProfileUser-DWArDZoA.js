const __vite__fileDeps=["./HeaderDiv-DB0skjjr.js","./index-BhwzwnLH.js","./index-6fGrG267.css","./LabelSlot-DtLQ-bg4.js","./_plugin-vue_export-helper-DlAUqK2U.js","./LabelSlot-BKRWK_aH.css","./UserForm-Dvj61-il.js","./state-BY_Xl-td.js","./utilities-DuY9392d.js","./BtnGroup-CWralO6M.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as E,i as $,n as L,j as m,c as b,b as l,u as a,g as R,w as r,F as C,B as U,o as _,y as n,t as o,a as f,e as p,f as c}from"./index-BhwzwnLH.js";import{d as g,e as v}from"./state-BY_Xl-td.js";import{s as y}from"./utilities-DuY9392d.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";const B={key:1,class:"mb-3"},P=["disabled"],V=E({__name:"ProfileUser",setup(I){const k=p(()=>c(()=>import("./HeaderDiv-DB0skjjr.js"),__vite__mapDeps([0,1,2]),import.meta.url)),s=p(()=>c(()=>import("./LabelSlot-DtLQ-bg4.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url)),w=p(()=>c(()=>import("./UserForm-Dvj61-il.js"),__vite__mapDeps([6,1,2,7,8]),import.meta.url)),D=p(()=>c(()=>import("./BtnGroup-CWralO6M.js"),__vite__mapDeps([9,1,2]),import.meta.url));$(async()=>{const u=U();e.value.id=u.params.id,await i("view")});const e=L({id:"",action:"",role:"",profile:{}});async function i(u){try{const t=await g.get(`${y}/user/${e.value.id}`,{params:{action:u}});e.value.profile=t.data,u==="drop"?v.setAlert("alert-success","Пароль сброшен"):u==="block"&&v.setAlert("alert-success",`Пользователь ${e.value.profile.blocked?"заблокирован":"разблокирован"}`)}catch(t){t.request.status==401||t.request.status==403?m.push({name:"login"}):console.error(t)}}async function A(){if(confirm("Вы действительно хотите удалить пользователя?"))try{(await g.delete(`${y}/user/${e.value.id}`)).status===204?(v.setAlert("alert-success","Пользователь отмечен к удалению"),i("view")):v.setAlert("alert-danger","Произошла ошибка")}catch(u){u.request.status==401||u.request.status==403?m.push({name:"login"}):console.error(u)}}return(u,t)=>(_(),b(C,null,[l(a(k),{"page-header":e.value.profile.fullname,cls:"text-secondary py-5"},null,8,["page-header"]),e.value.action?(_(),R(a(w),{key:0,action:e.value.action,item:e.value.profile,onUpdate:t[0]||(t[0]=d=>{e.value.action="",i("view")}),onCancel:t[1]||(t[1]=d=>{e.value.action=""})},null,8,["action","item"])):(_(),b("div",B,[l(a(s),{label:"ID"},{default:r(()=>[n(o(e.value.profile.id),1)]),_:1}),l(a(s),{label:"Регион"},{default:r(()=>[n(o(e.value.profile.region),1)]),_:1}),l(a(s),{label:"Имя пользователя"},{default:r(()=>[n(o(e.value.profile.fullname),1)]),_:1}),l(a(s),{label:"Логин"},{default:r(()=>[n(o(e.value.profile.username),1)]),_:1}),l(a(s),{label:"E-mail"},{default:r(()=>[n(o(e.value.profile.email),1)]),_:1}),l(a(s),{label:"Дата создания пароля"},{default:r(()=>[n(o(new Date(e.value.profile.pswd_create).toLocaleString("ru-RU")),1)]),_:1}),l(a(s),{label:"Требует смены пароля"},{default:r(()=>[n(o(e.value.profile.change_pswd?"Да":"Нет"),1)]),_:1}),l(a(s),{label:"Дата последнего входа"},{default:r(()=>[n(o(new Date(e.value.profile.last_login).toLocaleString("ru-RU")),1)]),_:1}),l(a(s),{label:"Попытки входа"},{default:r(()=>[n(o(e.value.profile.attempt),1)]),_:1}),l(a(s),{label:"Заблокирован"},{default:r(()=>[n(o(e.value.profile.blocked?"Заблокирован":"Разблокирован"),1)]),_:1}),l(a(s),{label:"Активность"},{default:r(()=>[n(o(e.value.profile.deleted?"Удален":"Активен"),1)]),_:1}),l(a(s),{label:"Администратор"},{default:r(()=>[n(o(e.value.profile.has_admin?"Да":"Нет"),1)]),_:1}),l(a(s),{label:"Дата создания профиля"},{default:r(()=>[n(o(new Date(e.value.profile.created).toLocaleString("ru-RU")),1)]),_:1}),l(a(s),{label:"Дата последнего изменения профиля"},{default:r(()=>[n(o(new Date(e.value.profile.updated).toLocaleString("ru-RU")),1)]),_:1}),l(a(D),{offset:!1},{default:r(()=>[f("button",{class:"btn btn-outline-primary",type:"button",onClick:t[2]||(t[2]=d=>e.value.action===""?e.value.action="edit":e.value.action="")},o(e.value.action===""?"Редактировать":"Отменить"),1),f("button",{onClick:t[3]||(t[3]=d=>i("block")),class:"btn btn-outline-info"},o(e.value.profile.blocked?"Разблокировать":"Заблокировать"),1),f("button",{onClick:t[4]||(t[4]=d=>i("drop")),type:"button",class:"btn btn-outline-secondary"}," Сбросить пароль "),f("button",{onClick:A,type:"button",class:"btn btn-outline-danger",disabled:e.value.profile.deleted}," Удалить ",8,P)]),_:1})]))],64))}}),h=x(V,[["__scopeId","data-v-eae4a94f"]]);export{h as default};
