const __vite__fileDeps=["./HeaderDiv-DQMckfaw.js","./index-2fGtmyHu.js","./index-BGNnvclF.css","./LabelSlot-CNcRoBCi.js","./_plugin-vue_export-helper-DlAUqK2U.js","./LabelSlot-BKRWK_aH.css","./UserForm-Dx-ItPMM.js","./utilities-DjwPzg-5.js","./state-BI0Epm2O.js","./BtnGroup-BM3JjHhl.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as C,f as E,m as k,r as m,c as b,a as l,u as t,i as x,w as o,F as L,B as R,o as c,t as n,x as r,h as _,b as d,e as p}from"./index-2fGtmyHu.js";import{d as v,s as T}from"./state-BI0Epm2O.js";import{b as y,s as g}from"./utilities-DjwPzg-5.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";const B={key:1,class:"mb-3"},I=["disabled"],P=C({__name:"ProfileUser",setup(V){const w=d(()=>p(()=>import("./HeaderDiv-DQMckfaw.js"),__vite__mapDeps([0,1,2]),import.meta.url)),s=d(()=>p(()=>import("./LabelSlot-CNcRoBCi.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url)),D=d(()=>p(()=>import("./UserForm-Dx-ItPMM.js"),__vite__mapDeps([6,1,2,7,8]),import.meta.url)),A=d(()=>p(()=>import("./BtnGroup-BM3JjHhl.js"),__vite__mapDeps([9,1,2]),import.meta.url));E(async()=>{const u=R();e.value.id=u.params.id,await i("view")});const e=k({id:"",action:"",role:"",profile:{}});async function i(u){try{const a=await y.get(`${g}/users/${e.value.id}`,{params:{action:u}});e.value.profile=a.data,u==="drop"&&v.setAlert("alert-success","Пароль сброшен")}catch(a){a.request.status==401||a.request.status==403?m.push({name:"login"}):console.error(a)}}async function U(){if(confirm("Вы действительно хотите удалить пользователя?"))try{(await y.delete(`${g}/users/${e.value.id}`)).status===204?(v.setAlert("alert-success","Пользователь отмечен к удалению"),i("view")):v.setAlert("alert-danger","Произошла ошибка")}catch(u){u.request.status==401||u.request.status==403?m.push({name:"login"}):console.error(u)}}return(u,a)=>(c(),b(L,null,[l(t(w),{"page-header":e.value.profile.fullname,cls:"text-secondary py-5"},null,8,["page-header"]),e.value.action?(c(),x(t(D),{key:0,action:e.value.action,item:e.value.profile,onUpdate:a[0]||(a[0]=f=>{e.value.action="",i("view")}),onCancel:a[1]||(a[1]=f=>{e.value.action=""})},null,8,["action","item"])):(c(),b("div",B,[l(t(s),{label:"ID"},{default:o(()=>[n(r(e.value.profile.id),1)]),_:1}),l(t(s),{label:"Регион"},{default:o(()=>[n(r(e.value.profile.region),1)]),_:1}),l(t(s),{label:"Имя пользователя"},{default:o(()=>[n(r(e.value.profile.fullname),1)]),_:1}),l(t(s),{label:"Логин"},{default:o(()=>[n(r(e.value.profile.username),1)]),_:1}),l(t(s),{label:"E-mail"},{default:o(()=>[n(r(e.value.profile.email),1)]),_:1}),l(t(s),{label:"Дата создания пароля"},{default:o(()=>[n(r(new Date(e.value.profile.pswd_create).toLocaleString("ru-RU")+" UTC"),1)]),_:1}),l(t(s),{label:"Требует смены пароля"},{default:o(()=>[n(r(e.value.profile.change_pswd?"Да":"Нет"),1)]),_:1}),l(t(s),{label:"Дата последнего входа"},{default:o(()=>[n(r(new Date(e.value.profile.last_login).toLocaleString("ru-RU")+" UTC"),1)]),_:1}),l(t(s),{label:"Попытки входа"},{default:o(()=>[n(r(e.value.profile.attempt),1)]),_:1}),l(t(s),{label:"Заблокирован"},{default:o(()=>[n(r(e.value.profile.blocked?"Заблокирован":"Разблокирован"),1)]),_:1}),l(t(s),{label:"Активность"},{default:o(()=>[n(r(e.value.profile.deleted?"Удален":"Активен"),1)]),_:1}),l(t(s),{label:"Администратор"},{default:o(()=>[n(r(e.value.profile.has_admin?"Да":"Нет"),1)]),_:1}),l(t(s),{label:"Дата создания профиля"},{default:o(()=>[n(r(new Date(e.value.profile.created).toLocaleString("ru-RU")+" UTC"),1)]),_:1}),l(t(A),{offset:!1},{default:o(()=>[_("button",{class:"btn btn-outline-primary",type:"button",onClick:a[2]||(a[2]=f=>e.value.action===""?e.value.action="edit":e.value.action="")},r(e.value.action===""?"Редактировать":"Отменить"),1),_("button",{onClick:a[3]||(a[3]=f=>i("drop")),type:"button",class:"btn btn-outline-secondary"}," Сбросить пароль "),_("button",{onClick:U,type:"button",class:"btn btn-outline-danger",disabled:e.value.profile.deleted||e.value.id==t(T).userId}," Удалить ",8,I)]),_:1})]))],64))}}),F=$(P,[["__scopeId","data-v-d2b1a90e"]]);export{F as default};
