import{a as n,s as o,b as c}from"./utilities-Dq58mqGZ.js";import{J as l,l as h,r as u}from"./index-8uvu1PmF.js";const I=l({userId:"",username:"",hasAdmin:!1});h(localStorage.getItem("user_token"));const $=l({regions:{},status:{},conclusions:{},relations:{},affilations:{},educations:{},addresses:{},contacts:{},documents:{},poligrafs:{}}),i={alertMessage:l({attr:"",text:""}),setAlert(s="",e=""){this.alertMessage.attr=s,this.alertMessage.text=e,setTimeout(()=>{this.setAlert()},1e4)}},f={anketa:l({persons:{},previous:[],educations:[],staffs:[],documents:[],addresses:[],contacts:[],relations:[],workplaces:[],affilations:[],checks:[],poligrafs:[],investigations:[],inquiries:[]}),share:l({candId:"",imageUrl:""}),async getItem(s,e="view"){if(!(e==="self"&&!confirm("Вы действительно назначить проверку кандидата на себя?")))try{const t=s==="image"?await n.get(`${o}/image/${this.share.candId}`,{responseType:"blob"}):await n.get(`${o}/${s}/${this.share.candId}`,{params:{action:e}});s==="image"?this.share.imageUrl=window.URL.createObjectURL(new Blob([t.data])):this.anketa[s]=t.data,e==="self"&&i.setAlert("alert-info","Анкета назначена пользователю")}catch(t){c(t)}},async updateItem(s,e){try{const t=await n.post(`${o}/${s}/${f.share.candId}`,e);console.log(t.status),["checks","poligrafs"].includes(s)&&this.getItem("persons"),this.getItem(s),i.setAlert("alert-success","Запись успешно добавлена")}catch(t){c(t)}},async deleteItem(s,e){if(confirm("Вы действительно хотите удалить запись?"))try{const t=await n.delete(`${o}/${e}/${s}`);console.log(t.status),e==="persons"?u.push({name:"persons"}):this.getItem(e),i.setAlert("alert-info",`Запись с ID ${s} удалена`)}catch(t){c(t)}}};async function w(s,e,t=f.share.candId){const d=new FormData,r=s.target;if(r&&r.files){for(let a=0;a<r.files.length;a++)if(r.files[a].size>10*1024*1024){i.setAlert("alert-warning","Превышен максимальный размер файла"),r.value="";return}else d.append("file",r.files[a]);try{const a=await n.post(`${o}/file/${e}/${t}`,d);if(console.log(a.status),e==="image"&&f.getItem(e),e==="persons"){const{person_id:g}=a.data;u.push({name:"profile",params:{id:g}})}i.setAlert("alert-success","Файл или файлы успешно загружен/добавлены")}catch(a){c(a)}}else i.setAlert("alert-warning","Ошибка при загрузке файла")}export{I as a,w as b,f as c,i as d,$ as s};
