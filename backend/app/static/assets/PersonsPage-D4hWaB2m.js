const __vite__fileDeps=["./HeaderDiv-DQMckfaw.js","./index-2fGtmyHu.js","./index-BGNnvclF.css","./FileForm-CVZorDRb.js","./_plugin-vue_export-helper-DlAUqK2U.js","./FileForm-By8_2B11.css","./TableSlots-l8ZcrkmY.js","./PageSwitcher-meZbWgdd.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as L,f as C,m as E,r as R,c as i,a as c,u as r,h as s,n as T,q as V,v as N,s as A,i as U,w as p,F as h,j as B,o as n,t as f,x as o,y as g,z as F,b as d,e as m}from"./index-2fGtmyHu.js";import{b as I,s as O,t as q,d as M}from"./utilities-DjwPzg-5.js";import{b as j}from"./state-BI0Epm2O.js";const z={class:"position-relative"},H={class:"position-absolute bottom-100 end-0"},J={key:0,for:"file",title:"Загрузить анкету",class:"text-primary fs-1 fw-normal",style:{cursor:"pointer"}},G={class:"row mb-3"},K={class:"form form-check",role:"form"},Q=s("div",{class:"fs-3"},"•",-1),W=[Q],X={height:"50px"},Y=["width"],Z={key:1},oe=L({__name:"PersonsPage",setup(ee){const w=d(()=>m(()=>import("./HeaderDiv-DQMckfaw.js"),__vite__mapDeps([0,1,2]),import.meta.url)),y=d(()=>m(()=>import("./FileForm-CVZorDRb.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url)),x=d(()=>m(()=>import("./TableSlots-l8ZcrkmY.js"),__vite__mapDeps([6,1,2]),import.meta.url)),b=d(()=>m(()=>import("./PageSwitcher-meZbWgdd.js"),__vite__mapDeps([7,1,2]),import.meta.url));C(async()=>{await u()});const D={Проверка:"primary",ПФО:"info",Окончено:"secondary",Сохранено:"danger"},$={id:["#","5%"],region_id:["Регион","15%"],surname:["Фамилия Имя Отчество","25%"],birthday:["Дата рождения","15%"],status:["Статус","10%"],created:["Создан","15%"],user:["Сотрудник","15%"]},t=E({candidates:[],page:1,prev:!1,next:!1,search:"",upload:!0,updated:`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`});async function u(l=1){t.value.page=l;try{const a=await I.get(`${O}/index/${t.value.page}`,{params:{search:t.value.search}});[t.value.candidates,t.value.next,t.value.prev]=a.data,t.value.updated=`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`}catch(a){a.request.status==401||a.request.status==403?R.push({name:"login"}):console.error(a)}}const v=M(()=>{u()},500);async function S(l){t.value.upload=!1,j(l,"persons","0"),t.value.upload=!0}const k=l=>{const[a,_]=l.split(" ");return`${a} ${_}`};return(l,a)=>{const _=B("router-link");return n(),i(h,null,[c(r(w),{"page-header":"Кандидаты"}),s("div",z,[s("div",H,[t.value.upload?(n(),i("label",J," ⊕ ")):T("",!0),c(r(y),{accept:".json",onSubmit:S},null,8,["accept"])])]),s("div",G,[s("form",K,[V(s("input",{onInput:a[0]||(a[0]=A((...e)=>r(v)&&r(v)(...e),["prevent"])),class:"form-control",name:"search",id:"search",type:"text",placeholder:"поиск по фамилии, имени, отчеству, инн","onUpdate:modelValue":a[1]||(a[1]=e=>t.value.search=e)},null,544),[[N,t.value.search]])])]),t.value.candidates.length?(n(),U(r(x),{key:0},{caption:p(()=>[f(o(`Обновлено: ${t.value.updated}`)+" ",1),s("a",{href:"#",title:"Обновить",onClick:a[2]||(a[2]=e=>u())},W)]),thead:p(()=>[s("tr",X,[(n(),i(h,null,g($,(e,P)=>s("th",{key:P,width:e[1]},o(e[0]),9,Y)),64))])]),tbody:p(()=>[(n(!0),i(h,null,g(t.value.candidates,e=>(n(),i("tr",{key:e.id,height:"50px"},[s("td",null,o(e.id),1),s("td",null,o(e.region),1),s("td",null,[c(_,{to:{name:"profile",params:{id:e.id}}},{default:p(()=>[f(o(`${e.surname} ${e.firstname} ${e.patronymic?e.patronymic:""}`),1)]),_:2},1032,["to"])]),s("td",null,o(new Date(e.birthday).toLocaleDateString("ru-RU")),1),s("td",null,[s("label",{class:F(`fs-6 badge bg-${D[e.status]}`)},o(e.status),3)]),s("td",null,o(r(q)(e.created)),1),s("td",null,o(e.username?k(e.username.toString()):""),1)]))),128))]),_:1})):(n(),i("p",Z,"Ничего не найдено")),c(r(b),{has_prev:t.value.prev,has_next:t.value.next,switchPrev:t.value.page-1,switchNext:t.value.page+1,onSwitch:u},null,8,["has_prev","has_next","switchPrev","switchNext"])],64)}}});export{oe as default};
