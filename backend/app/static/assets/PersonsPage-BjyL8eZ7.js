const __vite__fileDeps=["./HeaderDiv-BSaSfGiU.js","./index-DCiFGIcJ.js","./index-BqKjTnG4.css","./FileForm-DZljEFji.js","./_plugin-vue_export-helper-DlAUqK2U.js","./FileForm-By8_2B11.css","./TableSlots-C4V5h-xJ.js","./PageSwitcher-CRTvq2qF.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as L,f as C,m as E,r as R,c as i,a as c,u as n,h as s,n as T,q as V,v as N,s as A,i as U,w as p,F as h,j as B,o as l,t as f,x as r,y as g,z as F,b as m,e as d}from"./index-DCiFGIcJ.js";import{a as I,s as O,t as q,d as M}from"./utilities-DksN3XFX.js";import{b as j}from"./state-Kk6UeE2d.js";const z={class:"position-relative"},H={class:"position-absolute bottom-100 end-0 px-3"},J={key:0,for:"file",title:"Загрузить анкету",class:"text-primary fs-1 fw-light",style:{cursor:"pointer"}},G={class:"row mb-3"},K={class:"form form-check",role:"form"},Q={height:"50px"},W=["width"],X={key:1},se=L({__name:"PersonsPage",setup(Y){const w=m(()=>d(()=>import("./HeaderDiv-BSaSfGiU.js"),__vite__mapDeps([0,1,2]),import.meta.url)),y=m(()=>d(()=>import("./FileForm-DZljEFji.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url)),x=m(()=>d(()=>import("./TableSlots-C4V5h-xJ.js"),__vite__mapDeps([6,1,2]),import.meta.url)),b=m(()=>d(()=>import("./PageSwitcher-CRTvq2qF.js"),__vite__mapDeps([7,1,2]),import.meta.url));C(async()=>{await u()});const D=o=>{switch(o){case"Проверка":return"primary";case"ПФО":return"info";case"Окончено":return"secondary";case"Сохранено":return"warning"}},$={id:["#","5%"],region_id:["Регион","15%"],surname:["Фамилия Имя Отчество","25%"],birthday:["Дата рождения","15%"],status:["Статус","10%"],created:["Создан","15%"],user:["Сотрудник","15%"]},t=E({candidates:[],page:1,prev:!1,next:!1,search:"",upload:!0,updated:`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`});async function u(o=1){t.value.page=o;try{const a=await I.get(`${O}/index/${t.value.page}`,{params:{search:t.value.search}});[t.value.candidates,t.value.next,t.value.prev]=a.data,t.value.updated=`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`}catch(a){a.request.status==401||a.request.status==403?R.push({name:"login"}):console.error(a)}}const v=M(()=>{u()},500);async function k(o){t.value.upload=!1,j(o,"persons","0"),t.value.upload=!0}const S=o=>{const[a,_]=o.split(" ");return`${a} ${_}`};return(o,a)=>{const _=B("router-link");return l(),i(h,null,[c(n(w),{"page-header":"Кандидаты"}),s("div",z,[s("div",H,[t.value.upload?(l(),i("label",J," ✪ ")):T("",!0),c(n(y),{accept:".json",onSubmit:k})])]),s("div",G,[s("form",K,[V(s("input",{onInput:a[0]||(a[0]=A((...e)=>n(v)&&n(v)(...e),["prevent"])),class:"form-control",name:"search",id:"search",type:"text",placeholder:"поиск по фамилии, имени, отчеству, инн","onUpdate:modelValue":a[1]||(a[1]=e=>t.value.search=e)},null,544),[[N,t.value.search]])])]),t.value.candidates.length?(l(),U(n(x),{key:0},{caption:p(()=>[f(r(`Обновлено: ${t.value.updated}`)+" ",1),s("a",{class:"btn btn-link fs-5",href:"#",style:{"text-decoration":"none"},title:"Обновить",onClick:a[2]||(a[2]=e=>u())}," ↻ ")]),thead:p(()=>[s("tr",Q,[(l(),i(h,null,g($,(e,P)=>s("th",{key:P,width:e[1]},r(e[0]),9,W)),64))])]),tbody:p(()=>[(l(!0),i(h,null,g(t.value.candidates,e=>(l(),i("tr",{key:e.id,height:"50px"},[s("td",null,r(e.id),1),s("td",null,r(e.region),1),s("td",null,[c(_,{to:{name:"profile",params:{id:e.id}}},{default:p(()=>[f(r(`${e.surname} ${e.firstname} ${e.patronymic?e.patronymic:""}`),1)]),_:2},1032,["to"])]),s("td",null,r(new Date(e.birthday).toLocaleDateString("ru-RU")),1),s("td",null,[s("label",{class:F(`fs-6 badge bg-${D(e.status)}`)},r(e.status),3)]),s("td",null,r(n(q)(e.created)),1),s("td",null,r(e.username?S(e.username.toString()):""),1)]))),128))]),_:1})):(l(),i("p",X,"Ничего не найдено")),c(n(b),{has_prev:t.value.prev,has_next:t.value.next,switchPrev:t.value.page-1,switchNext:t.value.page+1,onSwitch:u},null,8,["has_prev","has_next","switchPrev","switchNext"])],64)}}});export{se as default};
