const __vite__fileDeps=["./HeaderDiv-BrJu6fvd.js","./index-BYAJzIZ5.js","./index-6fGrG267.css","./FileForm-Drsihsdz.js","./_plugin-vue_export-helper-DlAUqK2U.js","./FileForm-DJXAWPLZ.css","./SelectDiv-Cv6yX2kN.js","./TableSlots-B6c2wwRK.js","./AscDesc-L2jCd4z4.js","./AscDesc-BQH9JYAH.css","./PageSwitcher-DEBFnXDB.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as U,i as F,n as b,c as m,b as n,u as o,a as s,q as O,v as B,s as N,g as M,w as _,F as h,l as j,o as u,x as f,t as r,r as x,y as q,e as c,f as d}from"./index-BYAJzIZ5.js";import{s as S,t as z,d as H}from"./utilities-DuY9392d.js";import{d as E,c as $,e as P}from"./state-p7j6PBAe.js";const G={class:"position-relative"},J={class:"position-absolute bottom-100 end-0"},K=s("label",{for:"file",class:"text-primary"},[s("i",{class:"bi bi-cloud-arrow-down fs-1",title:"Загрузить анкету",style:{cursor:"pointer"}})],-1),Q={class:"row mb-3"},W={class:"col-md-2"},X={class:"col-md-10"},Y=s("i",{class:"bi bi-arrow-clockwise"},null,-1),Z=[Y],ee={height:"50px"},te=["width"],se={key:1},ne=U({__name:"PersonsPage",setup(ae){const V=c(()=>d(()=>import("./HeaderDiv-BrJu6fvd.js"),__vite__mapDeps([0,1,2]),import.meta.url)),A=c(()=>d(()=>import("./FileForm-Drsihsdz.js"),__vite__mapDeps([3,1,2,4,5]),import.meta.url)),C=c(()=>d(()=>import("./SelectDiv-Cv6yX2kN.js"),__vite__mapDeps([6,1,2]),import.meta.url)),L=c(()=>d(()=>import("./TableSlots-B6c2wwRK.js"),__vite__mapDeps([7,1,2]),import.meta.url)),g=c(()=>d(()=>import("./AscDesc-L2jCd4z4.js"),__vite__mapDeps([8,1,2,4,9]),import.meta.url)),R=c(()=>d(()=>import("./PageSwitcher-DEBFnXDB.js"),__vite__mapDeps([10,1,2]),import.meta.url));F(async()=>{await l()});const T={new:"success",repeat:"success",update:"success",manual:"primary",save:"primary",robot:"danger",poligraf:"info",error:"warning",cancel:"secondary",finish:"secondary"},k={id:["#","10%"],region_id:["Регион","15%"],surname:["Фамилия Имя Отчество","20%"],birthday:["Дата рождения","15%"],status:["Статус","10%"],created:["Создан","10%"],user:["Сотрудник","20%"]},e=b({candidates:[],items:{officer:"Мои кандидаты",search:"Все кандидаты"},page:1,prev:!1,next:!1,search:"",sort:"status",order:"asc",path:"search",updated:`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`});async function l(i=1){e.value.page=i;try{const a=await E.get(`${S}/index/${e.value.path}/${e.value.page}`,{params:{search:e.value.search,sort:e.value.sort,order:e.value.order}});[e.value.candidates,e.value.next,e.value.prev]=a.data,e.value.updated=`${new Date().toLocaleDateString("ru-RU")} в ${new Date().toLocaleTimeString("ru-RU")}`}catch(a){console.error(a)}}function w(i,a){e.value.sort=i,e.value.order=a,l()}const D=H(()=>{e.value.path="search",l()},500),y=b(new FormData);async function I(i){const a=i.target;if(a.files){y.value.append("file",a.files[0]);try{const p=await E.post(`${S}/file/anketa/0`,y.value);console.log(p.status),l(),P.setAlert("alert-success","Файл успешно загружен")}catch(p){console.error(p)}}else P.setAlert("alert-warning","Ошибка при загрузке файла")}return(i,a)=>{const p=j("router-link");return u(),m(h,null,[n(o(V),{"page-header":"Кандидаты"}),s("div",G,[s("div",J,[K,n(o(A),{accept:".json",onSubmit:I},null,8,["accept"])])]),s("div",Q,[s("div",W,[n(o(C),{name:"action",select:e.value.items,modelValue:e.value.path,"onUpdate:modelValue":a[0]||(a[0]=t=>e.value.path=t),onSubmitData:l},null,8,["select","modelValue"])]),s("div",X,[O(s("input",{onInput:a[1]||(a[1]=N((...t)=>o(D)&&o(D)(...t),["prevent"])),class:"form-control",name:"search",id:"search",type:"text",placeholder:"поиск по фамилии, имени, отчеству, инн","onUpdate:modelValue":a[2]||(a[2]=t=>e.value.search=t)},null,544),[[B,e.value.search]])])]),e.value.candidates.length?(u(),M(o(L),{key:0,"div-class":"table caption-top align-middle py-3"},{caption:_(()=>[f(r(`Обновлено: ${e.value.updated}`)+" ",1),s("a",{href:"#",title:"Обновить",onClick:a[3]||(a[3]=t=>l())},Z)]),thead:_(()=>[s("tr",ee,[(u(),m(h,null,x(k,(t,v)=>s("th",{key:v,width:t[1]},[f(r(t[0])+" ",1),n(o(g),{order:"desc",sort:v,onSortCandidates:w},null,8,["sort"]),n(o(g),{order:"asc",sort:v,onSortCandidates:w},null,8,["sort"])],8,te)),64))])]),tbody:_(()=>[(u(!0),m(h,null,x(e.value.candidates,t=>(u(),m("tr",{key:t.id,height:"50px"},[s("td",null,r(t.id),1),s("td",null,r(o($).regions[t.region]),1),s("td",null,[n(p,{to:{name:"profile",params:{id:t.id}}},{default:_(()=>[f(r(`${t.surname} ${t.firstname} ${t.patronymic?t.patronymic:""}`),1)]),_:2},1032,["to"])]),s("td",null,r(new Date(t.birthday).toLocaleDateString("ru-RU")),1),s("td",null,[s("label",{class:q(`fs-6 badge bg-${T[t.status]}`)},r(o($).status[t.status]),3)]),s("td",null,r(o(z)(t.created)),1),s("td",null,r(t.username?t.username:""),1)]))),128))]),_:1})):(u(),m("p",se,"Ничего не найдено")),n(o(R),{has_prev:e.value.prev,has_next:e.value.next,switchPrev:e.value.page-1,switchNext:e.value.page+1,onSwitch:l},null,8,["has_prev","has_next","switchPrev","switchNext"])],64)}}});export{ne as default};
