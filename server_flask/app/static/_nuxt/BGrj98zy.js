import{a as De,_ as $e}from"./F1l9jR7M.js";import{_ as Te}from"./DbEcqiiq.js";import{r as D,ac as fe,d as j,s as C,aa as Ce,a0 as ve,ab as Pe,al as L,ad as Ae,m as ge,au as Re,h as K,_ as be,j as he,k as ye,q as _e,t as G,L as Fe,af as se,ah as Oe,av as Ee,v as Ne,x as ke,aj as W,o as M,z as U,g as h,b as y,A,y as Q,f as $,c as R,am as Ue,T as we,C as H,B,F as ae,G as ne,ap as je,E,D as V,a9 as Ie,N as Be,w as Ve,O as Le,e as b,l as ze,H as He,u as ue}from"./DfFwspTN.js";import{_ as Ke}from"./DOviaxzH.js";import{_ as qe}from"./DXLMIV6O.js";import{_ as Me}from"./CJlo3cgU.js";import{e as Ze,o as x,w as Je,j as We,t as Ge,u as Qe,a as X,A as Y,i as oe,s as Xe,l as Ye,N as ie,b as S,v as et,g as de,_ as Se,O as tt,h as at}from"./Dpkrji5r.js";import{w as nt}from"./BW4YXBtG.js";import{u as lt}from"./CZvQ1gPa.js";import{_ as ot}from"./BhVxa_ul.js";import{_ as rt}from"./C5nlZ-H6.js";import{u as st}from"./Bg7MONkg.js";import{u as ut}from"./CSnMaNkz.js";import{a as it}from"./CifMPHan.js";import"./BY5lPLn4.js";import"./DfMykkUP.js";const dt={wrapper:"relative inline-flex items-center justify-center flex-shrink-0",base:"absolute rounded-full ring-1 ring-white dark:ring-gray-900 flex items-center justify-center text-white dark:text-gray-900 font-medium whitespace-nowrap",background:"bg-{color}-500 dark:bg-{color}-400",position:{"top-right":"top-0 right-0","bottom-right":"bottom-0 right-0","top-left":"top-0 left-0","bottom-left":"bottom-0 left-0"},translate:{"top-right":"-translate-y-1/2 translate-x-1/2 transform","bottom-right":"translate-y-1/2 translate-x-1/2 transform","top-left":"-translate-y-1/2 -translate-x-1/2 transform","bottom-left":"translate-y-1/2 -translate-x-1/2 transform"},size:{"3xs":"h-[4px] min-w-[4px] text-[4px] p-px","2xs":"h-[5px] min-w-[5px] text-[5px] p-px",xs:"h-1.5 min-w-[0.375rem] text-[6px] p-px",sm:"h-2 min-w-[0.5rem] text-[7px] p-0.5",md:"h-2.5 min-w-[0.625rem] text-[8px] p-0.5",lg:"h-3 min-w-[0.75rem] text-[10px] p-0.5",xl:"h-3.5 min-w-[0.875rem] text-[11px] p-1","2xl":"h-4 min-w-[1rem] text-[12px] p-1","3xl":"h-5 min-w-[1.25rem] text-[14px] p-1"},default:{size:"sm",color:"primary",position:"top-right",inset:!1}};function ce(e){return[e.screenX,e.screenY]}function ct(){let e=D([-1,-1]);return{wasMoved(r){let o=ce(r);return e.value[0]===o[0]&&e.value[1]===o[1]?!1:(e.value=o,!0)},update(r){e.value=ce(r)}}}function pt({container:e,accept:r,walk:o,enabled:d}){fe(()=>{let c=e.value;if(!c||d!==void 0&&!d.value)return;let n=Ze(e);if(!n)return;let t=Object.assign(m=>r(m),{acceptNode:r}),i=n.createTreeWalker(c,NodeFilter.SHOW_ELEMENT,t,!1);for(;i.nextNode();)o(i.currentNode)})}function mt(e){throw new Error("Unexpected object: "+e)}var T=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(T||{});function ft(e,r){let o=r.resolveItems();if(o.length<=0)return null;let d=r.resolveActiveIndex(),c=d??-1;switch(e.focus){case 0:{for(let n=0;n<o.length;++n)if(!r.resolveDisabled(o[n],n,o))return n;return d}case 1:{c===-1&&(c=o.length);for(let n=c-1;n>=0;--n)if(!r.resolveDisabled(o[n],n,o))return n;return d}case 2:{for(let n=c+1;n<o.length;++n)if(!r.resolveDisabled(o[n],n,o))return n;return d}case 3:{for(let n=o.length-1;n>=0;--n)if(!r.resolveDisabled(o[n],n,o))return n;return d}case 4:{for(let n=0;n<o.length;++n)if(r.resolveId(o[n],n,o)===e.id)return n;return d}case 5:return null;default:mt(e)}}let pe=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function me(e){var r,o;let d=(r=e.innerText)!=null?r:"",c=e.cloneNode(!0);if(!(c instanceof HTMLElement))return d;let n=!1;for(let i of c.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))i.remove(),n=!0;let t=n?(o=c.innerText)!=null?o:"":d;return pe.test(t)&&(t=t.replace(pe,"")),t}function vt(e){let r=e.getAttribute("aria-label");if(typeof r=="string")return r.trim();let o=e.getAttribute("aria-labelledby");if(o){let d=o.split(" ").map(c=>{let n=document.getElementById(c);if(n){let t=n.getAttribute("aria-label");return typeof t=="string"?t.trim():me(n).trim()}return null}).filter(Boolean);if(d.length>0)return d.join(", ")}return me(e).trim()}function gt(e){let r=D(""),o=D("");return()=>{let d=x(e);if(!d)return"";let c=d.innerText;if(r.value===c)return o.value;let n=vt(d).trim().toLowerCase();return r.value=c,o.value=n,n}}var bt=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(bt||{}),ht=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(ht||{});function yt(e){requestAnimationFrame(()=>requestAnimationFrame(e))}let xe=Symbol("MenuContext");function ee(e){let r=Ae(xe,null);if(r===null){let o=new Error(`<${e} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,ee),o}return r}let _t=j({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(e,{slots:r,attrs:o}){let d=D(1),c=D(null),n=D(null),t=D([]),i=D(""),m=D(null),_=D(1);function w(a=v=>v){let v=m.value!==null?t.value[m.value]:null,u=tt(a(t.value.slice()),p=>x(p.dataRef.domRef)),s=v?u.indexOf(v):null;return s===-1&&(s=null),{items:u,activeItemIndex:s}}let g={menuState:d,buttonRef:c,itemsRef:n,items:t,searchQuery:i,activeItemIndex:m,activationTrigger:_,closeMenu:()=>{d.value=1,m.value=null},openMenu:()=>d.value=0,goToItem(a,v,u){let s=w(),p=ft(a===T.Specific?{focus:T.Specific,id:v}:{focus:a},{resolveItems:()=>s.items,resolveActiveIndex:()=>s.activeItemIndex,resolveId:l=>l.id,resolveDisabled:l=>l.dataRef.disabled});i.value="",m.value=p,_.value=u??1,t.value=s.items},search(a){let v=i.value!==""?0:1;i.value+=a.toLowerCase();let u=(m.value!==null?t.value.slice(m.value+v).concat(t.value.slice(0,m.value+v)):t.value).find(p=>p.dataRef.textValue.startsWith(i.value)&&!p.dataRef.disabled),s=u?t.value.indexOf(u):-1;s===-1||s===m.value||(m.value=s,_.value=1)},clearSearch(){i.value=""},registerItem(a,v){let u=w(s=>[...s,{id:a,dataRef:v}]);t.value=u.items,m.value=u.activeItemIndex,_.value=1},unregisterItem(a){let v=w(u=>{let s=u.findIndex(p=>p.id===a);return s!==-1&&u.splice(s,1),u});t.value=v.items,m.value=v.activeItemIndex,_.value=1}};return nt([c,n],(a,v)=>{var u;g.closeMenu(),Je(v,We.Loose)||(a.preventDefault(),(u=x(c))==null||u.focus())},C(()=>d.value===0)),Ce(xe,g),Ge(C(()=>Qe(d.value,{0:X.Open,1:X.Closed}))),()=>{let a={open:d.value===0,close:g.closeMenu};return Y({ourProps:{},theirProps:e,slot:a,slots:r,attrs:o,name:"Menu"})}}}),kt=j({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(e,{attrs:r,slots:o,expose:d}){var c;let n=(c=e.id)!=null?c:`headlessui-menu-button-${oe()}`,t=ee("MenuButton");d({el:t.buttonRef,$el:t.buttonRef});function i(g){switch(g.key){case S.Space:case S.Enter:case S.ArrowDown:g.preventDefault(),g.stopPropagation(),t.openMenu(),L(()=>{var a;(a=x(t.itemsRef))==null||a.focus({preventScroll:!0}),t.goToItem(T.First)});break;case S.ArrowUp:g.preventDefault(),g.stopPropagation(),t.openMenu(),L(()=>{var a;(a=x(t.itemsRef))==null||a.focus({preventScroll:!0}),t.goToItem(T.Last)});break}}function m(g){switch(g.key){case S.Space:g.preventDefault();break}}function _(g){e.disabled||(t.menuState.value===0?(t.closeMenu(),L(()=>{var a;return(a=x(t.buttonRef))==null?void 0:a.focus({preventScroll:!0})})):(g.preventDefault(),t.openMenu(),yt(()=>{var a;return(a=x(t.itemsRef))==null?void 0:a.focus({preventScroll:!0})})))}let w=Xe(C(()=>({as:e.as,type:r.type})),t.buttonRef);return()=>{var g;let a={open:t.menuState.value===0},{...v}=e,u={ref:t.buttonRef,id:n,type:w.value,"aria-haspopup":"menu","aria-controls":(g=x(t.itemsRef))==null?void 0:g.id,"aria-expanded":t.menuState.value===0,onKeydown:i,onKeyup:m,onClick:_};return Y({ourProps:u,theirProps:v,slot:a,attrs:r,slots:o,name:"MenuButton"})}}}),wt=j({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(e,{attrs:r,slots:o,expose:d}){var c;let n=(c=e.id)!=null?c:`headlessui-menu-items-${oe()}`,t=ee("MenuItems"),i=D(null);d({el:t.itemsRef,$el:t.itemsRef}),pt({container:C(()=>x(t.itemsRef)),enabled:C(()=>t.menuState.value===0),accept(a){return a.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:a.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(a){a.setAttribute("role","none")}});function m(a){var v;switch(i.value&&clearTimeout(i.value),a.key){case S.Space:if(t.searchQuery.value!=="")return a.preventDefault(),a.stopPropagation(),t.search(a.key);case S.Enter:if(a.preventDefault(),a.stopPropagation(),t.activeItemIndex.value!==null){let u=t.items.value[t.activeItemIndex.value];(v=x(u.dataRef.domRef))==null||v.click()}t.closeMenu(),Se(x(t.buttonRef));break;case S.ArrowDown:return a.preventDefault(),a.stopPropagation(),t.goToItem(T.Next);case S.ArrowUp:return a.preventDefault(),a.stopPropagation(),t.goToItem(T.Previous);case S.Home:case S.PageUp:return a.preventDefault(),a.stopPropagation(),t.goToItem(T.First);case S.End:case S.PageDown:return a.preventDefault(),a.stopPropagation(),t.goToItem(T.Last);case S.Escape:a.preventDefault(),a.stopPropagation(),t.closeMenu(),L(()=>{var u;return(u=x(t.buttonRef))==null?void 0:u.focus({preventScroll:!0})});break;case S.Tab:a.preventDefault(),a.stopPropagation(),t.closeMenu(),L(()=>et(x(t.buttonRef),a.shiftKey?de.Previous:de.Next));break;default:a.key.length===1&&(t.search(a.key),i.value=setTimeout(()=>t.clearSearch(),350));break}}function _(a){switch(a.key){case S.Space:a.preventDefault();break}}let w=Ye(),g=C(()=>w!==null?(w.value&X.Open)===X.Open:t.menuState.value===0);return()=>{var a,v;let u={open:t.menuState.value===0},{...s}=e,p={"aria-activedescendant":t.activeItemIndex.value===null||(a=t.items.value[t.activeItemIndex.value])==null?void 0:a.id,"aria-labelledby":(v=x(t.buttonRef))==null?void 0:v.id,id:n,onKeydown:m,onKeyup:_,role:"menu",tabIndex:0,ref:t.itemsRef};return Y({ourProps:p,theirProps:s,slot:u,attrs:r,slots:o,features:ie.RenderStrategy|ie.Static,visible:g.value,name:"MenuItems"})}}}),It=j({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(e,{slots:r,attrs:o,expose:d}){var c;let n=(c=e.id)!=null?c:`headlessui-menu-item-${oe()}`,t=ee("MenuItem"),i=D(null);d({el:i,$el:i});let m=C(()=>t.activeItemIndex.value!==null?t.items.value[t.activeItemIndex.value].id===n:!1),_=gt(i),w=C(()=>({disabled:e.disabled,get textValue(){return _()},domRef:i}));ve(()=>t.registerItem(n,w)),Pe(()=>t.unregisterItem(n)),fe(()=>{t.menuState.value===0&&m.value&&t.activationTrigger.value!==0&&L(()=>{var l,k;return(k=(l=x(i))==null?void 0:l.scrollIntoView)==null?void 0:k.call(l,{block:"nearest"})})});function g(l){if(e.disabled)return l.preventDefault();t.closeMenu(),Se(x(t.buttonRef))}function a(){if(e.disabled)return t.goToItem(T.Nothing);t.goToItem(T.Specific,n)}let v=ct();function u(l){v.update(l)}function s(l){v.wasMoved(l)&&(e.disabled||m.value||t.goToItem(T.Specific,n,0))}function p(l){v.wasMoved(l)&&(e.disabled||m.value&&t.goToItem(T.Nothing))}return()=>{let{disabled:l,...k}=e,I={active:m.value,disabled:l,close:t.closeMenu};return Y({ourProps:{id:n,ref:i,role:"menuitem",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,onClick:g,onFocus:a,onPointerenter:u,onMouseenter:u,onPointermove:s,onMousemove:s,onPointerleave:p,onMouseleave:p},theirProps:{...o,...k},slot:I,attrs:o,slots:r,name:"MenuItem"})}}});const le=ge(K.ui.strategy,K.ui.dropdown,Re),Mt=j({components:{HMenu:_t,HMenuButton:kt,HMenuItems:wt,HMenuItem:It,UIcon:he,UAvatar:ye,UKbd:Me},inheritAttrs:!1,props:{items:{type:Array,default:()=>[]},mode:{type:String,default:"click",validator:e=>["click","hover"].includes(e)},open:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},popper:{type:Object,default:()=>({})},openDelay:{type:Number,default:()=>le.default.openDelay},closeDelay:{type:Number,default:()=>le.default.closeDelay},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},emits:["update:open"],setup(e,{emit:r}){const{ui:o,attrs:d}=_e("dropdown",G(e,"ui"),le,G(e,"class")),c=C(()=>Fe(e.mode==="hover"?{offsetDistance:0}:{},e.popper,o.value.popper)),[n,t]=lt(c.value),i=D(null);let m=null,_=null;ve(()=>{var k,I;const p=(k=n.value)==null?void 0:k.$.provides;if(!p)return;const l=Object.getOwnPropertySymbols(p);i.value=l.length&&p[l[0]],e.open&&((I=i.value)==null||I.openMenu())});const w=C(()=>{var I,P,F;if(e.mode!=="hover")return{};const p=((I=e.popper)==null?void 0:I.offsetDistance)||((P=o.value.popper)==null?void 0:P.offsetDistance)||8,l=(F=c.value.placement)==null?void 0:F.split("-")[0],k=`${p}px`;return l==="top"||l==="bottom"?{paddingTop:k,paddingBottom:k}:l==="left"||l==="right"?{paddingLeft:k,paddingRight:k}:{paddingTop:k,paddingBottom:k,paddingLeft:k,paddingRight:k}});function g(p){!p.cancelable||!i.value||e.mode==="click"||(i.value.menuState===0?i.value.closeMenu():i.value.openMenu())}function a(){e.mode!=="hover"||!i.value||(_&&(clearTimeout(_),_=null),i.value.menuState!==0&&(m=m||setTimeout(()=>{i.value.openMenu&&i.value.openMenu(),m=null},e.openDelay)))}function v(){e.mode!=="hover"||!i.value||(m&&(clearTimeout(m),m=null),i.value.menuState!==1&&(_=_||setTimeout(()=>{i.value.closeMenu&&i.value.closeMenu(),_=null},e.closeDelay)))}function u(p,l,{href:k,navigate:I,close:P,isExternal:F}){l.click&&l.click(p),k&&!F&&(I(p),P())}se(()=>e.open,(p,l)=>{i.value&&(l===void 0||p===l||(p?i.value.openMenu():i.value.closeMenu()))}),se(()=>{var p;return(p=i.value)==null?void 0:p.menuState},(p,l)=>{l===void 0||p===l||r("update:open",p===0)});const s=Ie;return at(()=>Oe()),{ui:o,attrs:d,popper:c,trigger:n,container:t,containerStyle:w,onTouchStart:g,onMouseEnter:a,onMouseLeave:v,onClick:u,getNuxtLinkProps:Ee,twMerge:Ne,twJoin:ke,NuxtLink:s}}}),St=["disabled"];function xt(e,r,o,d,c,n){const t=W("HMenuButton"),i=he,m=ye,_=Me,w=W("HMenuItem"),g=Ie,a=W("HMenuItems"),v=W("HMenu");return M(),U(v,H({as:"div",class:e.ui.wrapper},e.attrs,{onMouseleave:e.onMouseLeave}),{default:h(({open:u})=>[y(t,{ref:"trigger",as:"div",disabled:e.disabled,class:A(e.ui.trigger),role:"button",onMouseenter:e.onMouseEnter,onTouchstartPassive:e.onTouchStart},{default:h(()=>[Q(e.$slots,"default",{open:u,disabled:e.disabled},()=>[$("button",{disabled:e.disabled}," Open ",8,St)])]),_:2},1032,["disabled","class","onMouseenter","onTouchstartPassive"]),u&&e.items.length?(M(),R("div",{key:0,ref:"container",class:A([e.ui.container,e.ui.width]),style:Ue(e.containerStyle),onMouseenter:r[0]||(r[0]=(...s)=>e.onMouseEnter&&e.onMouseEnter(...s))},[y(we,H({appear:""},e.ui.transition),{default:h(()=>[$("div",null,[e.popper.arrow?(M(),R("div",{key:0,"data-popper-arrow":"",class:A(Object.values(e.ui.arrow))},null,2)):B("",!0),y(a,{class:A([e.ui.base,e.ui.divide,e.ui.ring,e.ui.rounded,e.ui.shadow,e.ui.background,e.ui.height]),static:""},{default:h(()=>[(M(!0),R(ae,null,ne(e.items,(s,p)=>(M(),R("div",{key:p,class:A(e.ui.padding)},[(M(!0),R(ae,null,ne(s,(l,k)=>(M(),U(g,H({key:k,ref_for:!0},e.getNuxtLinkProps(l),{custom:""}),{default:h(({href:I,target:P,rel:F,navigate:te,isExternal:q,isActive:z})=>[y(w,{disabled:l.disabled},{default:h(({active:Z,disabled:f,close:O})=>[(M(),U(je(I?"a":"button"),{href:f?void 0:I,rel:F,target:P,class:A(e.twMerge(e.twJoin(e.ui.item.base,e.ui.item.padding,e.ui.item.size,e.ui.item.rounded,Z||z?e.ui.item.active:e.ui.item.inactive,f&&e.ui.item.disabled),l.class)),onClick:J=>e.onClick(J,l,{href:I,navigate:te,close:O,isExternal:q})},{default:h(()=>[Q(e.$slots,l.slot||"item",{item:l},()=>{var J;return[l.icon?(M(),U(i,{key:0,name:l.icon,class:A(e.twMerge(e.twJoin(e.ui.item.icon.base,Z||z?e.ui.item.icon.active:e.ui.item.icon.inactive),l.iconClass))},null,8,["name","class"])):l.avatar?(M(),U(m,H({key:1,ref_for:!0},{size:e.ui.item.avatar.size,...l.avatar},{class:e.ui.item.avatar.base}),null,16,["class"])):B("",!0),$("span",{class:A(e.twMerge(e.ui.item.label,l.labelClass))},E(l.label),3),(J=l.shortcuts)!=null&&J.length?(M(),R("span",{key:2,class:A(e.ui.item.shortcuts)},[(M(!0),R(ae,null,ne(l.shortcuts,re=>(M(),U(_,{key:re},{default:h(()=>[V(E(re),1)]),_:2},1024))),128))],2)):B("",!0)]})]),_:2},1032,["href","rel","target","class","onClick"]))]),_:2},1032,["disabled"])]),_:2},1040))),128))],2))),128))]),_:3},8,["class"])])]),_:3},16)],38)):B("",!0)]),_:3},16,["class","onMouseleave"])}const Dt=be(Mt,[["render",xt]]),N=ge(K.ui.strategy,K.ui.chip,dt),$t=j({inheritAttrs:!1,props:{size:{type:String,default:()=>N.default.size,validator(e){return Object.keys(N.size).includes(e)}},color:{type:String,default:()=>N.default.color,validator(e){return["gray",...K.ui.colors].includes(e)}},position:{type:String,default:()=>N.default.position,validator(e){return Object.keys(N.position).includes(e)}},text:{type:[String,Number],default:null},inset:{type:Boolean,default:()=>N.default.inset},show:{type:Boolean,default:!0},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(e){const{ui:r,attrs:o}=_e("chip",G(e,"ui"),N,G(e,"class")),d=C(()=>ke(r.value.base,r.value.size[e.size],r.value.position[e.position],e.inset?null:r.value.translate[e.position],r.value.background.replaceAll("{color}",e.color)));return{ui:r,attrs:o,chipClass:d}}});function Tt(e,r,o,d,c,n){return M(),R("div",H({class:e.ui.wrapper},e.attrs),[Q(e.$slots,"default"),e.show?(M(),R("span",{key:0,class:A(e.chipClass)},[Q(e.$slots,"content",{},()=>[V(E(e.text),1)])],2)):B("",!0)],16)}const Ct=be($t,[["render",Tt]]),Pt={class:"my-6"},At={class:"flex items-center justify-between mb-4"},Rt={class:"flex grid grid-cols-7 gap-3 border rounded p-3"},Ft={class:"col-span-2"},Ot={class:"col-span-2"},Et={class:"col-span-2"},Nt={class:"col-span-1"},Ut={class:"text-center"},jt={class:"text-center"},Bt={class:"text-center"},na=j({__name:"users",async setup(e){let r,o;const d=Be(),c=st(),n=ut(),t=D({search:"",userId:"",region:"",role:"",users:[],form:{},collapsed:!1,viewDeleted:!1}),i=C(()=>t.value.users.filter(u=>u.deleted==t.value.viewDeleted)),{refresh:m,status:_}=([r,o]=Ve(async()=>it("users",async()=>{t.value.users=await c("/api/users",{params:{search:t.value.search}})})),r=await r,o(),r);async function w(u,s=t.value.userId){if(s==n.value.id){d.add({icon:"i-heroiconsi-heroicons-information-circle",title:"Внимание",description:"Невозможно  выполнить действие",color:"red"});return}confirm("Подтвердите действие!")&&(await c("/api/users/"+s,{params:{item:u}}),Object.assign(t.value,{userId:"",region:"",role:""}),await m(),d.add({icon:"i-heroicons-check-circle",title:"Информация",description:"Действие успешно выполнено",color:"green"}))}async function g(){const{message:u}=await c("/api/users",{method:"POST",body:t.value.form});t.value.collapsed=!1,Object.assign(t.value.form,{fullname:"",username:""}),u==="success"?(await m(),d.add({icon:"i-heroicons-check-circle",title:"Информация",description:"Пользователь успешно добавлен",color:"green"})):d.add({icon:"i-heroiconsi-heroicons-information-circle",title:"Внимание",description:"Ошибка данных или пользователь уже существует",color:"red"})}const a=u=>{const s=[];return u.fullname&&!u.fullname.match(/^[а-яёЁА-Я-\s]+$/)&&s.push({path:"fullname",message:"Поле должно содержать только русские буквы"}),u.username&&!u.username.match(/^[a-zA-Z_\s]+$/)&&s.push({path:"username",message:"Поле должно содержать только латинские буквы и знаки подчеркивания"}),u.email&&!u.email.match(/^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/)&&s.push({path:"email",message:"Поле должно содержать корректную почту"}),s};Le(()=>t.value.search,()=>{m()},{debounce:500,maxWait:1e3});const v=[[{label:"Сбросить пароль",click:()=>w("drop")}],[{label:"Заблокировать/разблокировать",click:()=>w("block")}],[{label:"Удалить/восстановить",click:()=>w("delete")}]];return(u,s)=>{const p=$e,l=De,k=Te,I=ze,P=Ke,F=qe,te=Dt,q=ot,z=Ct,Z=rt;return M(),R("div",null,[y(p,{div:"py-1",cls:"text-2xl text-gray-500",header:"ПОЛЬЗОВАТЕЛИ"}),$("div",Pt,[y(l,{modelValue:b(t).search,"onUpdate:modelValue":s[0]||(s[0]=f=>b(t).search=f),size:"lg",placeholder:"Поиск по имени пользователя"},null,8,["modelValue"])]),$("div",At,[y(k,{modelValue:b(t).viewDeleted,"onUpdate:modelValue":s[1]||(s[1]=f=>b(t).viewDeleted=f),label:"Показать удаленные"},null,8,["modelValue"]),y(I,{variant:"link",label:"Добавить пользователя",onClick:s[2]||(s[2]=f=>b(t).collapsed=!b(t).collapsed)})]),y(we,{name:"slide-fade"},{default:h(()=>[b(t).collapsed?(M(),U(F,{key:0,state:b(t).form,validate:a,onSubmit:He(g,["prevent"])},{default:h(()=>[$("div",Rt,[$("div",Ft,[y(P,{required:"",class:"mb-3",name:"fullname"},{default:h(()=>[y(l,{modelValue:b(t).form.fullname,"onUpdate:modelValue":s[3]||(s[3]=f=>b(t).form.fullname=f),placeholder:"Имя пользователя"},null,8,["modelValue"])]),_:1})]),$("div",Ot,[y(P,{required:"",class:"mb-3",name:"username"},{default:h(()=>[y(l,{modelValue:b(t).form.username,"onUpdate:modelValue":s[4]||(s[4]=f=>b(t).form.username=f),placeholder:"Логин"},null,8,["modelValue"])]),_:1})]),$("div",Et,[y(P,{required:"",class:"mb-3",name:"email"},{default:h(()=>[y(l,{modelValue:b(t).form.email,"onUpdate:modelValue":s[5]||(s[5]=f=>b(t).form.email=f),placeholder:"Email"},null,8,["modelValue"])]),_:1})]),$("div",Nt,[y(I,{block:"",variant:"outline",color:"gray",label:"Создать",type:"submit"})])])]),_:1},8,["state"])):B("",!0)]),_:1}),y(Z,{loading:b(_)==="pending",progress:{color:"red",animation:"swing"},"empty-state":{icon:"i-heroicons-circle-stack-20-solid",label:"Пользователи не найдены."},columns:[{key:"id",label:"#"},{key:"fullname",label:"Пользователь"},{key:"username",label:"Логин"},{key:"email",label:"Email"},{key:"region",label:"Регион"},{key:"role",label:"Роль"},{key:"created",label:"Создан"},{key:"attempt",label:"Попытка"},{key:"blocked",label:"Блок"},{key:"pswd_create",label:"Обновлен"},{key:"change_pswd",label:"Изм.пароля"}],rows:b(i)},{"id-data":h(({row:f})=>[V(E(f.id),1)]),"fullname-data":h(({row:f})=>[V(E(f.fullname),1)]),"username-data":h(({row:f})=>[y(te,{items:v},{default:h(()=>[y(I,{variant:"link",label:f.username,onClick:O=>b(t).userId=f.id},null,8,["label","onClick"])]),_:2},1024)]),"region-data":h(({row:f})=>[y(q,{modelValue:b(t).region,"onUpdate:modelValue":s[6]||(s[6]=O=>b(t).region=O),placeholder:f.region,options:["Главный офис","РЦ Юг","РЦ Запад","РЦ Урал","РЦ Восток"],onChange:O=>w(b(t).region,f.id)},null,8,["modelValue","placeholder","onChange"])]),"role-data":h(({row:f})=>[y(q,{modelValue:b(t).role,"onUpdate:modelValue":s[7]||(s[7]=O=>b(t).role=O),placeholder:f.role,options:["admin","user","guest"],onChange:O=>w(b(t).role,f.id)},null,8,["modelValue","placeholder","onChange"])]),"created-data":h(({row:f})=>[V(E(b(ue)(f.created).value),1)]),"attempt-data":h(({row:f})=>[$("div",Ut,E(f.attempt),1)]),"blocked-data":h(({row:f})=>[$("div",jt,[y(z,{size:"2xl",color:f.blocked?"red":"green"},null,8,["color"])])]),"pswd_create-data":h(({row:f})=>[V(E(b(ue)(f.pswd_create).value),1)]),"change_pswd-data":h(({row:f})=>[$("div",Bt,[y(z,{size:"2xl",color:f.change_pswd?"red":"green"},null,8,["color"])])]),_:1},8,["loading","rows"])])}}});export{na as default};
