import{m as x,J,h as j,_ as Q,d as O,l as W,t as L,q as A,K as G,r as b,L as X,o as d,c as m,x as B,C as p,z as f,b as r,g as l,f as g,A as D,D as c,F as Z,E as ee,y as ae,B as F,T as te,M as oe,w as ne,N as se,O as le,P as ie,n as E,p as re,e as o,Q as ue,k as de,u as pe,a as ce,i as me}from"./DSZgY0GN.js";import{a as fe,_ as ye}from"./DuoSnw_b.js";import{_ as ve}from"./DUza1bqK.js";import{_ as z}from"./DQwVk_Y1.js";import{u as be}from"./Dvr36W2A.js";import{u as ge}from"./BVt5O5o3.js";import{u as he}from"./Ce3U9u9Y.js";import{a as _e}from"./DXFhoKA3.js";import"./9XQBD0WK.js";import"./Ci_tIRZB.js";const U=x(j.ui.strategy,j.ui.tooltip,J),ke=O({components:{UKbd:z},inheritAttrs:!1,props:{text:{type:String,default:null},prevent:{type:Boolean,default:!1},shortcuts:{type:Array,default:()=>[]},openDelay:{type:Number,default:()=>U.default.openDelay},closeDelay:{type:Number,default:()=>U.default.closeDelay},popper:{type:Object,default:()=>({})},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(e){const{ui:n,attrs:k}=W("tooltip",L(e,"ui"),U,L(e,"class")),h=A(()=>G({},e.popper,n.value.popper)),[C,T]=be(h.value),u=b(!1);let t=null,s=null;const _=A(()=>!!(X().text||e.text));function y(){s&&(clearTimeout(s),s=null),!u.value&&(t=t||setTimeout(()=>{u.value=!0,t=null},e.openDelay))}function $(){t&&(clearTimeout(t),t=null),u.value&&(s=s||setTimeout(()=>{u.value=!1,s=null},e.closeDelay))}return{ui:n,attrs:k,popper:h,trigger:C,container:T,open:u,onMouseEnter:y,onMouseLeave:$,isVisible:_}}});function we(e,n,k,h,C,T){const u=z;return d(),m("div",F({ref:"trigger",class:e.ui.wrapper},e.attrs,{onMouseenter:n[0]||(n[0]=(...t)=>e.onMouseEnter&&e.onMouseEnter(...t)),onMouseleave:n[1]||(n[1]=(...t)=>e.onMouseLeave&&e.onMouseLeave(...t))}),[B(e.$slots,"default",{open:e.open},()=>[n[2]||(n[2]=p(" Hover "))]),e.open&&!e.prevent&&e.isVisible?(d(),m("div",{key:0,ref:"container",class:f([e.ui.container,e.ui.width])},[r(te,F({appear:""},e.ui.transition),{default:l(()=>{var t;return[g("div",null,[e.popper.arrow?(d(),m("div",{key:0,"data-popper-arrow":"",class:f(Object.values(e.ui.arrow))},null,2)):D("",!0),g("div",{class:f([e.ui.base,e.ui.background,e.ui.color,e.ui.rounded,e.ui.shadow,e.ui.ring])},[B(e.$slots,"text",{},()=>[p(c(e.text),1)]),(t=e.shortcuts)!=null&&t.length?(d(),m("span",{key:0,class:f(e.ui.shortcuts)},[g("span",{class:f(e.ui.middot)},"·",2),(d(!0),m(Z,null,ee(e.shortcuts,s=>(d(),ae(u,{key:s,size:"xs"},{default:l(()=>[p(c(s),1)]),_:2},1024))),128))],2)):D("",!0)],2)])]}),_:3},16)],2)):D("",!0)],16)}const De=Q(ke,[["render",we]]),Ce={key:0,class:"relative"},Te={class:"my-6"},$e={class:"caption-bottom text-left mt-2"},Se={key:1,class:"justify-center flex pt-4"},Oe=O({__name:"persons",async setup(e){let n,k;const h=ge(),C=he(),T=oe(),u=b([]),t=b(1),s=b(!1),_=b(!1),y=b(""),$=b("Данные обновляются..."),{refresh:S,status:M}=([n,k]=ne(async()=>_e("candidates",async()=>{[u.value,s.value]=await h("/api/index/"+t.value,{params:{search:y.value}}),$.value=pe(ce(),"DD.MM.YYYY в HH:mm").value})),n=await n,k(),n);se(()=>y.value,()=>{S()},{debounce:500,maxWait:1e3}),le(()=>t.value,()=>{S()});const{open:H,reset:N,onCancel:P,onChange:Y}=ie({accept:".json",multiple:!1});return Y(async w=>{if(!w)return;_.value=!0;const i=new FormData;i.append("file",w[0]);const{person_id:v}=await h("/api/json",{method:"POST",body:i});if(N(),_.value=!1,v)return await S(),E("/profile/"+v);T.add({icon:"i-heroiconsi-heroicons-information-circle",title:"Внимание",description:"Файл не был загружен",color:"red"})}),P(()=>{N()}),re("/profile/[id]"),(w,i)=>{const v=de,I=ye,K=fe,R=me,q=ve,V=De;return d(),m("div",null,[o(C).role=="user"?(d(),m("div",Ce,[g("div",{class:f(["absolute inset-y-0 right-0",{"animate-pulse":o(M)=="pending"||o(_)}])},[r(v,{icon:"i-heroicons-cloud-arrow-up",title:"Загрузить json файл",size:"xl",variant:"ghost",onClick:o(H)},null,8,["onClick"])],2)])):D("",!0),r(I,{header:"КАНДИДАТЫ"}),g("div",Te,[r(K,{modelValue:o(y),"onUpdate:modelValue":i[0]||(i[0]=a=>ue(y)?y.value=a:null),placeholder:"поиск по фамилии, имени, отчеству"},null,8,["modelValue"])]),r(q,{loading:o(M)=="pending"||o(_),progress:{color:"red",animation:"swing"},"empty-state":{icon:"i-heroicons-circle-stack-20-solid",label:"Данные не найдены."},columns:[{key:"id",label:"#"},{key:"region",label:"Регион"},{key:"surname",label:"Фамилия Имя Отчество"},{key:"birthday",label:"Дата рождения"},{key:"inn",label:"ИНН"},{key:"snils",label:"СНИЛС"},{key:"created",label:"Обновлено"},{key:"username",label:"Сотрудник"},{key:"editable",label:"Статус"}],rows:o(u),onSelect:i[1]||(i[1]=a=>("navigateTo"in w?w.navigateTo:o(E))(`/profile/${a.id}`))},{"id-data":l(({row:a})=>[p(c(a.id),1)]),"region-data":l(({row:a})=>[p(c(a.region),1)]),"surname-data":l(({row:a})=>[p(c(`${a.surname} ${a.firstname} ${a.patronymic?a.patronymic:""}`),1)]),"birthday-data":l(({row:a})=>[p(c(new Date(a.birthday).toLocaleDateString()),1)]),"created-data":l(({row:a})=>[p(c(new Date(a.created).toLocaleDateString()),1)]),"username-data":l(({row:a})=>[p(c(a.username?a.username.toString().split(" ")[0]:""),1)]),"editable-data":l(({row:a})=>[g("div",{class:f(["text-start",a.editable?"text-red-600":"text-primary"])},[r(R,{name:a.editable?"i-heroicons-arrow-path":"i-heroicons-check-circle",class:f(["w-6 h-6",{" animate-spin":a.editable}])},null,8,["name","class"])],2)]),caption:l(()=>[g("caption",$e,[r(v,{variant:"link",icon:"i-heroicons-arrow-path",label:`Обновлено: ${o($)}`,loading:o(M)=="pending",onClick:o(S)},null,8,["label","loading","onClick"])])]),_:1},8,["loading","rows"]),o(t)>1||o(s)?(d(),m("div",Se,[r(V,{text:"Предыдущая страница"},{default:l(()=>[r(v,{icon:"i-heroicons-arrow-small-left-20-solid",disabled:o(t)<2,ui:{rounded:"rounded-full"},class:"me-2",onClick:i[2]||(i[2]=a=>t.value--)},null,8,["disabled"])]),_:1}),r(V,{text:"Следующая страница"},{default:l(()=>[r(v,{icon:"i-heroicons-arrow-small-right-20-solid",disabled:!o(s),ui:{rounded:"rounded-full"},class:"ms-2",onClick:i[3]||(i[3]=a=>t.value++)},null,8,["disabled"])]),_:1})])):D("",!0)])}}});export{Oe as default};
