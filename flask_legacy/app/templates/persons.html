{% extends "index.html" %}

{% block title %}
Кандидаты
{% endblock %}

{% block content %}
<div class="text-opacity-85 text-primary py-5 px-3"><h3>Кандидаты</h3></div>
<div class="row mb-3">
  <form 
    @submit="{{ url_for('route.get_index', page=1) }}"
    class="form form-check" 
    role="form" 
    method="get" 
  >
    <input
      class="form-control"
      name="search"
      id="search"
      type="text"
      placeholder="поиск по фамилии, имени, отчеству, дате рождения, инн"
    />
  </form>
</div>
<div class="row py-3">
  <table class="table align-middle table-hover">
    <caption>
      <a 
        class="btn btn-link" 
        href="{{ url_for('route.get_index', page=page) }}" 
        style="text-decoration: none;"
      >Обновить &#8635
      </a>
    </caption>
    <thead>
      <tr height="50px">
        <th width="5%">#</th>
        <th width="15%">Регион</th>
        <th>Фамилия Имя Отчество</th>
        <th width="15%">Дата рождения</th>
        <th width="15%">Обновлено</th>
        <th width="15%">Сотрудник</th>
        <th width="5%" class="text-center">Статус</th>
      </tr>
    </thead>
      {% for row in candidates %}
      <tr>
        <td>{{ row['id'] }}</td>
        <td>{{ row['region'] }}</td>
        <td>{{ "%s %s %s" | format(row['surname'], row['firstname'], row['patronymic' if row['patronymic'] else '']) }}</td>
        <td>{{ row['birthday'].strftime("%d.%m.%Y") }}</td>
        <td>{{ row['created'].strftime("%d.%m.%Y") }}</td>
        <td>{{ row['username'] }}</td>
        <td class="text-center">
          {% if row.standing %}
          <div
            class="spinner-border spinner-grow-sm text-danger"
            role="status"
            :title="'Проверка'"
          >
          </div>
          {% else %}
          <div class="text-success fs-5" title="Окончено">
            <i class="bi bi-emoji-smile"></i>
          </div>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
  </table>
</div>
{% if not candidates|length %}
<p class="fs-6 taxt-danger">Ничего не найдено</p>
{% endif %}

{% if has_next or has_prev %}
<nav class="mb-4">
  <ul class="pagination justify-content-center">
    {% if has_prev %}
    <li class="page-item">
      <a
        :disabled="!state.statePersons.persons.prev"
        class="link-primary" 
        href="{{ url_for('route.get_index', page=page - 1) }}"
      >
        <i class="bi bi-chevron-double-left"></i>
        Назад 
      </a>
    </li>
    {% endif %}
    {% if has_next %}
    <li class="page-item">
      <a 
        :disabled="!state.statePersons.persons.next"
        class="link-primary" 
        href="{{ url_for('route.get_index', page=page + 1) }}"
      >
        Вперёд
        <i class="bi bi-chevron-double-right"></i>
      </a>
    </li>
    {% endif %}
  </ul>
</nav>
{% endif %}
{% endblock %}